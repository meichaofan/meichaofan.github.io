<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>go defer | huany</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1.前言defer语句用于延迟函数的调用，每次defer都会把一个函数压入栈中，函数返回前，再把延迟函数取出并执行。 为了方便描述，我们把创建defer的函数称为主函数，defer语句后面的函数称为延迟函数。 延迟函数可能有输入参数，这些参数可能来源于定义defer的函数，延迟函数也可能引用主函数用于返回的变量，也就是说延迟函数可能会影响主函数的一些行为，这些场景下，如果不了解defer的规则很容">
<meta name="keywords" content="go">
<meta property="og:type" content="article">
<meta property="og:title" content="go defer">
<meta property="og:url" content="https://meichaofan.github.io/2019/07/06/go-defer/index.html">
<meta property="og:site_name" content="huany">
<meta property="og:description" content="1.前言defer语句用于延迟函数的调用，每次defer都会把一个函数压入栈中，函数返回前，再把延迟函数取出并执行。 为了方便描述，我们把创建defer的函数称为主函数，defer语句后面的函数称为延迟函数。 延迟函数可能有输入参数，这些参数可能来源于定义defer的函数，延迟函数也可能引用主函数用于返回的变量，也就是说延迟函数可能会影响主函数的一些行为，这些场景下，如果不了解defer的规则很容">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://image.huany.top/hexo/go/defer.jpg">
<meta property="og:updated_time" content="2019-07-06T05:01:20.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="go defer">
<meta name="twitter:description" content="1.前言defer语句用于延迟函数的调用，每次defer都会把一个函数压入栈中，函数返回前，再把延迟函数取出并执行。 为了方便描述，我们把创建defer的函数称为主函数，defer语句后面的函数称为延迟函数。 延迟函数可能有输入参数，这些参数可能来源于定义defer的函数，延迟函数也可能引用主函数用于返回的变量，也就是说延迟函数可能会影响主函数的一些行为，这些场景下，如果不了解defer的规则很容">
<meta name="twitter:image" content="http://image.huany.top/hexo/go/defer.jpg">
  
    <link rel="alternate" href="/usr/local/openresty/nginx/html/blog/atom.xml" title="huany" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/usr/local/openresty/nginx/html/blog/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/usr/local/openresty/nginx/html/blog/" id="logo">huany</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/usr/local/openresty/nginx/html/blog/">Home</a>
        
          <a class="main-nav-link" href="/usr/local/openresty/nginx/html/blog/categories">Categories</a>
        
          <a class="main-nav-link" href="/usr/local/openresty/nginx/html/blog/categories/tec">Tec</a>
        
          <a class="main-nav-link" href="/usr/local/openresty/nginx/html/blog/categories/read-note">ReadNote</a>
        
          <a class="main-nav-link" href="/usr/local/openresty/nginx/html/blog/categories/life">Life</a>
        
          <a class="main-nav-link" href="/usr/local/openresty/nginx/html/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/usr/local/openresty/nginx/html/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://meichaofan.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-go-defer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/usr/local/openresty/nginx/html/blog/2019/07/06/go-defer/" class="article-date">
  <time datetime="2019-07-06T02:25:32.000Z" itemprop="datePublished">2019-07-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      go defer
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h3><p>defer语句用于延迟函数的调用，每次defer都会把一个函数压入栈中，函数返回前，再把延迟函数取出并执行。</p>
<p>为了方便描述，我们把创建defer的函数称为主函数，defer语句后面的函数称为延迟函数。</p>
<p>延迟函数可能有输入参数，这些参数可能来源于定义defer的函数，延迟函数也可能引用主函数用于返回的变量，也就是说延迟函数可能会影响主函数的一些行为，这些场景下，如果不了解defer的规则很容易出错。</p>
<p>其实官方说明的defer的三个原则很清楚，本节试图汇总defer的使用场景并做简单说明。</p>
<h3 id="2-热身"><a href="#2-热身" class="headerlink" title="2.热身"></a>2.热身</h3><h4 id="2-1-题目一"><a href="#2-1-题目一" class="headerlink" title="2.1 题目一"></a>2.1 题目一</h4><p>下面函数输出结果是什么？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">func deferFuncParameter() &#123;</span><br><span class="line">    var aInt = 1</span><br><span class="line"></span><br><span class="line">    defer fmt.Println(aInt)</span><br><span class="line"></span><br><span class="line">    aInt = 2</span><br><span class="line">    return</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目说明：</p>
<p>函数deferFuncParameter()定义一个整型变量并初始化为1，然后使用defer语句打印出变量值，最后修改变量值为2.</p>
<p>参考答案：</p>
<p>输出1。延迟函数fmt.Println(aInt)的参数在defer语句出现时就已经确定了，所以无论后面如何修改aInt变量都不会影响延迟函数。</p>
<h4 id="2-2-题目二"><a href="#2-2-题目二" class="headerlink" title="2.2 题目二"></a>2.2 题目二</h4><p>下面程序输出什么？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">func printArray(array *[3]int) &#123;</span><br><span class="line">    for i := range array &#123;</span><br><span class="line">        fmt.Println(array[i])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func deferFuncParameter() &#123;</span><br><span class="line">    var aArray = [3]int&#123;1, 2, 3&#125;</span><br><span class="line"></span><br><span class="line">    defer printArray(&amp;aArray)</span><br><span class="line"></span><br><span class="line">    aArray[0] = 10</span><br><span class="line">    return</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    deferFuncParameter()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数说明：</p>
<p>函数deferFuncParameter()定义一个数组，通过defer延迟函数printArray()的调用，最后修改数组第一个元素。printArray()函数接受数组的指针并把数组全部打印出来。</p>
<p>参考答案：</p>
<p>输出10、2、3三个值。延迟函数printArray()的参数在defer语句出现时就已经确定了，即数组的地址，由于延迟函数执行时机是在return语句之前，所以对数组的最终修改值会被打印出来。</p>
<h4 id="2-3-题目三"><a href="#2-3-题目三" class="headerlink" title="2.3 题目三"></a>2.3 题目三</h4><p>下面函数输出什么？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func deferFuncReturn() (result int) &#123;</span><br><span class="line">    i := 1</span><br><span class="line"></span><br><span class="line">    defer func() &#123;</span><br><span class="line">       result++</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    return i</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数说明：</p>
<p>函数拥有一个具名返回值result，函数内部声明一个变量i，defer指定一个延迟函数，最后返回变量i。延迟函数中递增result。</p>
<p>参考答案：</p>
<p>函数输出2。函数的return语句并不是原子的，实际执行分为设置返回值–&gt;ret，defer语句实际执行在返回前，即拥有defer的函数返回过程是：设置返回值–&gt;执行defer–&gt;ret。所以return语句先把result设置为i的值，即1，defer语句中又把result递增1，所以最终返回2。</p>
<h3 id="3-defer规则"><a href="#3-defer规则" class="headerlink" title="3. defer规则"></a>3. defer规则</h3><p>Golang官方博客里总结了defer的行为规则，只有三条，我们围绕这三条进行说明。</p>
<h4 id="3-1-规则一：延迟函数的参数在defer语句出现时就已经确定下来了"><a href="#3-1-规则一：延迟函数的参数在defer语句出现时就已经确定下来了" class="headerlink" title="3.1 规则一：延迟函数的参数在defer语句出现时就已经确定下来了"></a>3.1 规则一：延迟函数的参数在defer语句出现时就已经确定下来了</h4><p>官方给出了一个例子，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">func a()&#123;</span><br><span class="line">    i := 0 </span><br><span class="line">    defer fmt.Println(i)</span><br><span class="line">    i++</span><br><span class="line">    return</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>defer语句中的fmt.Println()参数i值在defer出现时就已经确定下来，实际上是拷贝了一份。后面对变量i的修改不会影响fmt.Println()函数的执行，仍然打印”0”。</p>
<p>注意：对于指针类型参数，规则仍然适用，只不过延迟函数的参数是一个地址值，这种情况下，defer后面的语句对变量的修改可能会影响延迟函数。</p>
<h4 id="3-2-规则二：延迟函数执行按后进先出顺序执行，即先出现的defer最后执行"><a href="#3-2-规则二：延迟函数执行按后进先出顺序执行，即先出现的defer最后执行" class="headerlink" title="3.2 规则二：延迟函数执行按后进先出顺序执行，即先出现的defer最后执行"></a>3.2 规则二：延迟函数执行按后进先出顺序执行，即先出现的defer最后执行</h4><p>这个规则很好理解，定义defer类似于入栈操作，执行defer类似于出栈操作。</p>
<p>设计defer的初衷是简化函数返回时资源清理的动作，资源往往有依赖顺序，比如先申请A资源，再跟据A资源申请B资源，跟据B资源申请C资源，即申请顺序是:A–&gt;B–&gt;C，释放时往往又要反向进行。这就是把deffer设计成LIFO(Last In First Out)的原因。</p>
<p>每申请到一个用完需要释放的资源时，立即定义一个defer来释放资源是个很好的习惯。</p>
<h4 id="3-3-规则三：延迟函数可能操作主函数的具名返回值"><a href="#3-3-规则三：延迟函数可能操作主函数的具名返回值" class="headerlink" title="3.3 规则三：延迟函数可能操作主函数的具名返回值"></a>3.3 规则三：延迟函数可能操作主函数的具名返回值</h4><p>定义defer的函数，即主函数可能有返回值，返回值有没有名字没有关系，defer所作用的函数，即延迟函数可能会影响到返回值。</p>
<p>若要理解延迟函数是如何影响主函数返回值的，只要明白函数是如何返回的就足够了。</p>
<h6 id="3-1-函数返回过程"><a href="#3-1-函数返回过程" class="headerlink" title="3.1 函数返回过程"></a>3.1 函数返回过程</h6><p>有一个事实必须要了解，关键字<code>return</code>不是一个原子操作，实际上<code>return</code>只代理汇编指令<code>ret</code>，即将跳转程序执行。比如语句<code>return i</code>，实际上分两步进行，即将<code>i</code>存入栈中作为返回值，然后执行跳转，而defer的执行时机正是<strong>跳转前</strong>，所示说defer执行时还是有机会操作返回值的。</p>
<p>举个实际的例子进行说明这个过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func deferFuncReturn() (result int) &#123;</span><br><span class="line">    i := 1</span><br><span class="line"></span><br><span class="line">    defer func() &#123;</span><br><span class="line">       result++</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    return i</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该函数的return语句可以拆分成下面两行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = i</span><br><span class="line">return</span><br></pre></td></tr></table></figure>
<p>而延迟函数的执行正是在return之前，即加入defer后执行过程如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result = i</span><br><span class="line">result ++ </span><br><span class="line">return</span><br></pre></td></tr></table></figure>
<p>所以上面函数实际返回i++值。</p>
<p>关于主函数有不同的返回方式，但返回机制就如上机介绍所说，只要把return语句拆开都可以很好的理解，下面分别举例说明</p>
<h5 id="3-1-1-主函数拥有匿名返回值，返回字面值"><a href="#3-1-1-主函数拥有匿名返回值，返回字面值" class="headerlink" title="3.1.1 主函数拥有匿名返回值，返回字面值"></a>3.1.1 主函数拥有匿名返回值，返回字面值</h5><p>一个主函数拥有一个匿名的返回值，返回时使用字面值，比如返回”1”、”2”、”Hello”这样的值，这种情况下defer语句是无法操作返回值的。</p>
<p>一个返回字面值的函数，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func foo() int &#123;</span><br><span class="line">    var i int</span><br><span class="line"></span><br><span class="line">    defer func() &#123;</span><br><span class="line">        i++</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    return 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的return语句，直接把1写入栈中作为返回值，延迟函数无法操作该返回值，所以就无法影响返回值。</p>
<h5 id="3-3-2-主函数拥有匿名返回值，返回变量"><a href="#3-3-2-主函数拥有匿名返回值，返回变量" class="headerlink" title="3.3.2 主函数拥有匿名返回值，返回变量"></a>3.3.2 主函数拥有匿名返回值，返回变量</h5><p>一个主函数拥有一个匿名的返回值，返回使用本地或全局变量，这种情况下defer语句可以引用到返回值，但不会改变返回值。</p>
<p>一个返回本地变量的函数，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func foo() int &#123;</span><br><span class="line">    var i int</span><br><span class="line"></span><br><span class="line">    defer func() &#123;</span><br><span class="line">        i++</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    return i</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的函数，返回一个局部变量，同时defer函数也会操作这个局部变量。对于匿名返回值来说，可以假定仍然有一个变量存储返回值，假定返回值变量为”anony”，上面的返回语句可以拆分成以下过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">anony = i</span><br><span class="line">i++</span><br><span class="line">return</span><br></pre></td></tr></table></figure>
<p>由于i是整型，会将值拷贝给anony，所以defer语句中修改i值，对函数返回值不造成影响。</p>
<h5 id="3-3-3-主函数拥有具名返回值"><a href="#3-3-3-主函数拥有具名返回值" class="headerlink" title="3.3.3 主函数拥有具名返回值"></a>3.3.3 主函数拥有具名返回值</h5><p>主函声明语句中带名字的返回值，会被初始化成一个局部变量，函数内部可以像使用局部变量一样使用该返回值。如果defer语句操作该返回值，可能会改变返回结果。</p>
<p>一个影响函返回值的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">func foo() (ret int) &#123;</span><br><span class="line">    defer func() &#123;</span><br><span class="line">        ret++</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的函数拆解出来，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ret = 0</span><br><span class="line">ret++</span><br><span class="line">return</span><br></pre></td></tr></table></figure>
<p>函数真正返回前，在defer中对返回值做了+1操作，所以函数最终返回1。</p>
<h3 id="4-defer实现原理"><a href="#4-defer实现原理" class="headerlink" title="4. defer实现原理"></a>4. defer实现原理</h3><p>本节我们尝试了解一些defer的实现机制。</p>
<h4 id="4-1-defer数据结构"><a href="#4-1-defer数据结构" class="headerlink" title="4.1 defer数据结构"></a>4.1 defer数据结构</h4><p>源码包<code>src/src/runtime/runtime2.go:_defer</code>定义了defer的数据结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">type _defer struct &#123;</span><br><span class="line">    sp      uintptr   //函数栈指针</span><br><span class="line">    pc      uintptr   //程序计数器</span><br><span class="line">    fn      *funcval  //函数地址</span><br><span class="line">    link    *_defer   //指向自身结构的指针，用于链接多个defer</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们知道defer后面一定要接一个函数的，所以defer的数据结构跟一般函数类似，也有栈地址、程序计数器、函数地址等等。</p>
<p>与函数不同的一点是它含有一个指针，可用于指向另一个defer，每个goroutine数据结构中实际上也有一个defer指针，该指针指向一个defer的单链表，每次声明一个defer时就将defer插入到单链表表头，每次执行defer时就从单链表表头取出一个defer执行。</p>
<p>下图展示多个defer被链接的过程：</p>
<p><img src="http://image.huany.top/hexo/go/defer.jpg" alt></p>
<p>从上图可以看到，新声明的defer总是添加到链表头部。函数返回前执行defer则是从链表首部依次取出执行。</p>
<p>一个goroutine可能连续调用多个函数，defer添加过程跟上述流程一致，进入函数时添加defer，离开函数时取出defer，所有即便调用多个函数，也总能保证defer是按照LIFO方式执行 的。</p>
<h4 id="4-2-defer的创建和执行"><a href="#4-2-defer的创建和执行" class="headerlink" title="4.2 defer的创建和执行"></a>4.2 defer的创建和执行</h4><p>源码包<code>src/runtine/panic.go</code>定义了两个方法分别用于创建defer和执行defer。</p>
<ul>
<li>deferproc()：在声明defer处调用，其将defer函数存入goroutine的链表中；</li>
<li>deferreturn()：在return指令，准确的将是在ret指令前调用，其将defer从goroutine链表中取出并执行。</li>
</ul>
<p>可以简单的这么理解，在编译阶段，声明defer出插入了deferproc()，在函数return前插入了deferreturn()。</p>
<h3 id="5-总结"><a href="#5-总结" class="headerlink" title="5. 总结"></a>5. 总结</h3><ul>
<li>defer定义的延迟函数参数在defer语句出来时就已经确定下来了</li>
<li>defer定义顺序与执行顺序相反</li>
<li>return不是原子操作，执行过程是：保存返回值（若有） –&gt; 执行defer –&gt; 执行return跳转</li>
<li>申请资源后立即使用defer关闭资源是好习惯</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://meichaofan.github.io/2019/07/06/go-defer/" data-id="ckghaz98d0016ckd87s3008x7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/go/">go</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/usr/local/openresty/nginx/html/blog/2019/07/06/go-select/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          go select
        
      </div>
    </a>
  
  
    <a href="/usr/local/openresty/nginx/html/blog/2019/07/06/go-iota/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">go iota</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/C/">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/CSRF/">CSRF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/Desktop/">Desktop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/DevOps/">DevOps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/Docker/">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/Go/">Go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/Makefile/">Makefile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/PHP/">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/Redis/">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/c/">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/cli/">cli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/image/">image</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/k8s/">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/leetcode/">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/life/">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/numpy/">numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/overlay2/">overlay2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/overlayFs/">overlayFs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/printf/">printf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/runC/">runC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/runlevel/">runlevel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/samba/">samba</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/valgrind/">valgrind</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/web安全/">web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/倒排索引/">倒排索引</a></li><li class="tag-list-item"><a class="tag-list-link" href="/usr/local/openresty/nginx/html/blog/tags/容器/">容器</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/usr/local/openresty/nginx/html/blog/tags/C/" style="font-size: 16.67px;">C</a> <a href="/usr/local/openresty/nginx/html/blog/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/usr/local/openresty/nginx/html/blog/tags/Desktop/" style="font-size: 10px;">Desktop</a> <a href="/usr/local/openresty/nginx/html/blog/tags/DevOps/" style="font-size: 10px;">DevOps</a> <a href="/usr/local/openresty/nginx/html/blog/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/usr/local/openresty/nginx/html/blog/tags/Go/" style="font-size: 10px;">Go</a> <a href="/usr/local/openresty/nginx/html/blog/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/usr/local/openresty/nginx/html/blog/tags/Makefile/" style="font-size: 10px;">Makefile</a> <a href="/usr/local/openresty/nginx/html/blog/tags/PHP/" style="font-size: 11.67px;">PHP</a> <a href="/usr/local/openresty/nginx/html/blog/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/usr/local/openresty/nginx/html/blog/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/usr/local/openresty/nginx/html/blog/tags/c/" style="font-size: 11.67px;">c</a> <a href="/usr/local/openresty/nginx/html/blog/tags/cli/" style="font-size: 10px;">cli</a> <a href="/usr/local/openresty/nginx/html/blog/tags/docker/" style="font-size: 18.33px;">docker</a> <a href="/usr/local/openresty/nginx/html/blog/tags/go/" style="font-size: 20px;">go</a> <a href="/usr/local/openresty/nginx/html/blog/tags/http/" style="font-size: 10px;">http</a> <a href="/usr/local/openresty/nginx/html/blog/tags/image/" style="font-size: 10px;">image</a> <a href="/usr/local/openresty/nginx/html/blog/tags/k8s/" style="font-size: 10px;">k8s</a> <a href="/usr/local/openresty/nginx/html/blog/tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="/usr/local/openresty/nginx/html/blog/tags/life/" style="font-size: 11.67px;">life</a> <a href="/usr/local/openresty/nginx/html/blog/tags/linux/" style="font-size: 15px;">linux</a> <a href="/usr/local/openresty/nginx/html/blog/tags/numpy/" style="font-size: 10px;">numpy</a> <a href="/usr/local/openresty/nginx/html/blog/tags/overlay2/" style="font-size: 10px;">overlay2</a> <a href="/usr/local/openresty/nginx/html/blog/tags/overlayFs/" style="font-size: 10px;">overlayFs</a> <a href="/usr/local/openresty/nginx/html/blog/tags/php/" style="font-size: 10px;">php</a> <a href="/usr/local/openresty/nginx/html/blog/tags/printf/" style="font-size: 10px;">printf</a> <a href="/usr/local/openresty/nginx/html/blog/tags/python/" style="font-size: 10px;">python</a> <a href="/usr/local/openresty/nginx/html/blog/tags/runC/" style="font-size: 10px;">runC</a> <a href="/usr/local/openresty/nginx/html/blog/tags/runlevel/" style="font-size: 10px;">runlevel</a> <a href="/usr/local/openresty/nginx/html/blog/tags/samba/" style="font-size: 10px;">samba</a> <a href="/usr/local/openresty/nginx/html/blog/tags/ubuntu/" style="font-size: 13.33px;">ubuntu</a> <a href="/usr/local/openresty/nginx/html/blog/tags/valgrind/" style="font-size: 10px;">valgrind</a> <a href="/usr/local/openresty/nginx/html/blog/tags/web安全/" style="font-size: 10px;">web安全</a> <a href="/usr/local/openresty/nginx/html/blog/tags/倒排索引/" style="font-size: 10px;">倒排索引</a> <a href="/usr/local/openresty/nginx/html/blog/tags/容器/" style="font-size: 10px;">容器</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/usr/local/openresty/nginx/html/blog/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/usr/local/openresty/nginx/html/blog/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/usr/local/openresty/nginx/html/blog/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/usr/local/openresty/nginx/html/blog/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/usr/local/openresty/nginx/html/blog/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/usr/local/openresty/nginx/html/blog/archives/2019/03/">March 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/usr/local/openresty/nginx/html/blog/2019/08/26/install-k8s/">利用kubeadm安装k8s</a>
          </li>
        
          <li>
            <a href="/usr/local/openresty/nginx/html/blog/2019/08/02/linux-json-format/">linux下json解析神器 - jq</a>
          </li>
        
          <li>
            <a href="/usr/local/openresty/nginx/html/blog/2019/08/01/printf-console-color/">设定printf在终端输出字体的颜色</a>
          </li>
        
          <li>
            <a href="/usr/local/openresty/nginx/html/blog/2019/07/31/clion-create-multi-project/">clion建立多级工作目录</a>
          </li>
        
          <li>
            <a href="/usr/local/openresty/nginx/html/blog/2019/07/26/sword-finger-offer-3-1/">剑指Offer - 3.1 - 数组中重复的数字</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 meichaofan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/usr/local/openresty/nginx/html/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/usr/local/openresty/nginx/html/blog/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/usr/local/openresty/nginx/html/blog/categories/tec" class="mobile-nav-link">Tec</a>
  
    <a href="/usr/local/openresty/nginx/html/blog/categories/read-note" class="mobile-nav-link">ReadNote</a>
  
    <a href="/usr/local/openresty/nginx/html/blog/categories/life" class="mobile-nav-link">Life</a>
  
    <a href="/usr/local/openresty/nginx/html/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/usr/local/openresty/nginx/html/blog/fancybox/jquery.fancybox.css">
  <script src="/usr/local/openresty/nginx/html/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/usr/local/openresty/nginx/html/blog/js/script.js"></script>



  </div>
</body>
</html>